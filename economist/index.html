<!doctype html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>The Economist</title>
	<link rel="stylesheet" type="text/css" href="css/search-form.css">
    <link rel="stylesheet" href="../font-awesome-4.4.0/css/font-awesome.min.css"  type="text/css">
    <link rel="icon" type="image/x-icon" class="js-site-favicon" href="../images/favicon.ico">
	
	<!--[if IE]>
		<script src="http://libs.baidu.com/html5shiv/3.7/html5shiv.min.js"></script>
	<![endif]-->
</head>
<body>
    <header>
        <h1 class="title"><img src="./img/econfinal_favicon.ico">The Economist</h1>
        <div class="row">

        <div class="col-six tab-full pull-right social">

            <ul class="links"> 
             <li><a href="https://github.com/LockeyCheng" target="_blank"><i class="fa fa-github"></i></a></li>        
             <li><a href="https://blog.csdn.net/lockey23" target="_blank"><i class="fa fa-edit"></i></a></li>
             <li><a href="https://www.facebook.com/chen.yang.98031506"><i class="fa fa-facebook"></i></a></li>
             <li><a href="#"><i class="fa fa-twitter"></i></a></li>
             <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
             <!-- <li><a href="#"><i class="fa fa-vimeo"></i></a></li> -->
             <li><a href="#"><i class="fa fa-rss"></i></a></li>       
           </ul> 
      </div>
      </div>
    </header>
	<section class="container">
		<form onsubmit="submitFn(this, event);">
            <div class="search-wrapper">
                <div class="input-holder">
                    <input type="text" class="search-input" placeholder="Type to search" />
                    <button class="search-icon" onclick="searchToggle(this, event);"><span></span></button>
                </div>
                <span class="close" onclick="searchToggle(this, event);"></span>
                <div class="result-container">

                </div>
            </div>
        </form>
	</section>
    <div class="searchResult">
        <div>
            <p class="wordName">tragedy</p>
            <p><span class="wordTitle">发音：</span>英 [<span class="pronEg"></span>] 美 [<span class="pronAm"></span>]</span></p>
            <p><span class="wordTitle">释义（中）：</span><span class="wordExplanationCN"></span></p>
            <p><span class="wordTitle">释义（英）：</span><span class="wordExplanationEG"></span></p>
            <p><span class="wordTitle">变形：</span><span class="wordRelations"></span></p>
            <p><span class="wordTitle">例句：</span><span class="wordSentence"></span></p>
        </div>
    </div>
    <div class="everydayMotto">
        <p class="todayMotto"></p>
        <p class="todayMottoAuthor"></p>
        <p class="todayMottoCn"></p>
        <p class="time"></p>
    </div>
    <footer>
    <div class="row">
    <div class="col-six tab-full">
        <div class="copyright">
                <span>Copyright © 2017-2018 Created by Lockey All rights reserved.<a target="_blank" href="https://lockeycheng.github.io">www.lockey.io</a></span> 
             </div>                       
        </div>

    </div> <!-- /row -->   
<audio controls autoplay="autoplay" style="display: none">
    <source src="../music/again.mp3" type="audio/mpeg">
您的浏览器不支持 audio 元素。
</audio>    
</footer>  
	
	<script src="../js/jquery-2.1.1.js"></script>
	<script type="text/javascript">
        $(document).ready(function () {
        var jsonData = {}
        try { 
           var dictData = $.get("./explanations/explanation.json",function(data,status){console.log(status)});
           var jsonData = dictData.responseJSON
        } catch(err) { 
           console.log(err)
        } 
        function searchToggle(obj, evt){
            var container = $(obj).closest('.search-wrapper');

            if(!container.hasClass('active')){
                  container.addClass('active');
                  evt.preventDefault();
                  $('.everydayMotto').hide()
                  $('footer').hide()
            }
            else if(container.hasClass('active') && $(obj).closest('.input-holder').length == 0){
                  container.removeClass('active');
                  // clear input
                  container.find('.search-input').val('');
                  // clear and hide result container when we press close
                  container.find('.result-container').fadeOut(100, function(){$(this).empty();});
                  $('.searchResult').hide()
                  $('.everydayMotto').show()
                  $('footer').show()
            }
        }

        function submitFn(obj, evt){
            value = $(obj).find('.search-input').val().trim();

            _html = "Yup yup! Your search text sounds like this: ";
            if(!value.length){
                _html = "Yup yup! Add some text friend :D";
            }
            else{
                _html += "<b>" + value + "</b>";
            }

            $(obj).find('.result-container').html('<span>' + _html + '</span>');
            
            if(jsonData[value]){
                $('.searchResult').show()
                $('.wordName').text(value)
                $('.pronEg').text(jsonData[value]['pronunciations']['uk'])
                $('.pronAm').text(jsonData[value]['pronunciations']['us'])
                $('.wordExplanationCN').text(jsonData[value]['cn_definition']['defn'])
                $('.wordExplanationEG').text(jsonData[value]['en_definition']['defn'])
                $('.wordRelations').text(jsonData[value]['relation'])
                $('.wordSentence').text(jsonData[value]['sentence'])
            }else{
                $(obj).find('.result-container').html('<span class="error">' + value + '</span> is not in The Economist\'s words list!');
            }
            $(obj).find('.result-container').fadeIn(100);
            
            evt.preventDefault();
        }
        setInterval(
          function welcome(){
          var timeNow = Date()
          var timeSplit = timeNow.split(" ")
          var hms = timeSplit[4]
          var timeStr = timeSplit[0]+" "+timeSplit[1]+" "+ timeSplit[2]+" "+timeSplit[3]+" "+hms

          $('.time').html(timeStr)
        },1000)
        $('.todayMotto').html("I am not afraid of tomorrow for I have seen yesterday and I love today.")
        $('.todayMottoAuthor').html("- William Allen White")
        $('.todayMottoCn').html("我并不害怕明天，因为我已见过昨天并且热爱今天。")
        })
    </script>

</body>
</html>